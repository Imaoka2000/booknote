<h1>ユーザー設定</h1>

<div data-controller="profile-image">
  <%= form_with model: @user, url: user_settings_path, local: true, html: { multipart: true } do |form| %>
    <div class="mb-3">
      <%= form.label :username, "ユーザー名" %>
      <%= form.text_field :username, class: "form-control" %>
    </div>

    <div class="mb-3">
      <%= form.label :email, "メールアドレス" %>
      <%= form.email_field :email, class: "form-control" %>
    </div>

    <div class="mb-3">
      <%= form.label :profile_image, "プロフィール画像" %>
      <%= form.file_field :profile_image, class: "form-control", id: "profile_image_input", data: { "profile-image-target": "input" } %>
      <div class="mt-2">
        <img id="profile_image_preview"
             src="<%= @user.profile_image.attached? ? url_for(@user.profile_image) : '/images/dummy.png' %>"
             width="150" height="150"
             class="rounded-circle"
             alt="プロフィール画像プレビュー"
             data-profile-image-target="preview">
      </div>
    </div>

    <hr>

    <div class="mb-3">
      <%= form.label :password, "新しいパスワード" %>
      <%= form.password_field :password, class: "form-control", autocomplete: "new-password" %>
    </div>

    <div class="mb-3">
      <%= form.label :password_confirmation, "パスワード（確認）" %>
      <%= form.password_field :password_confirmation, class: "form-control", autocomplete: "new-password" %>
    </div>
    <%= form.submit "更新する", class: "btn btn-primary" %>
  <% end %>
</div>
